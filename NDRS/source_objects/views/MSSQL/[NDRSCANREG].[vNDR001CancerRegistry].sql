USE [LondonISL_National]
GO

/****** Object:  View [NDRSCANREG].[vNDR001CancerRegistry]    Script Date: 14/10/2025 10:43:15 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



CREATE   VIEW [NDRSCANREG].[vNDR001CancerRegistry] AS


select 
 t.SK
,t.Snapshot
,t.PATIENT_ID
,t.TUMOUR_ID
,t.[NHS_NUMBER Pseudo]
,t.BIRTHDATEFLAG
,t.GENDER
,t.ETHNICITY
,t.ETHNICITYNAME
,t.AGE
,t.FIVEYEARAGEBAND
,t.VITALSTATUS
,t.VITALSTATUSDATE
,t.DEATHDATEBEST
,t.DEATHDATEFLAG
,t.EMBARKATION
,t.EMBARKATIONDATE
,t.DEATHCAUSECODE_UNDERLYING
,t.DEATHLOCATIONCODE
,t.DEATHLOCATIONDESC
,t.SITECODEOFDEATH
,t.POSTMORTEM
,t.DCO
,t.DIAGNOSISDATEBEST
,t.DIAGNOSISDATEFLAG
,t.DIAGNOSISYEAR
,t.FINANCIALYEAR
,t.MORPH_ICD10_O2
,t.MORPH_ICDO3REV2011
,t.BEHAVIOUR_ICD10_O2
,t.BEHAVIOUR_ICDO3REV2011
,t.SITE_ICDO3REV2011
,t.SITE_ICDO3REV2011_3CHAR
,t.SITE_ICD10
,t.SITE_ICD10_3CHAR
,t.CTYA_CLASSIFICATION_PRIMARY
,t.CTYA_CLASSIFICATION_SECONDARY
,t.CTYA_CLASSIFICATION_TERTIARY
,t.CTYA_CLASSIFICATION_QUATERNARY
,t.T_BEST
,t.N_BEST
,t.M_BEST
,t.STAGE_BEST
,t.STAGE_BEST_SYSTEM
,t.NODESEXCISED
,t.NODESINVOLVED
,t.LATERALITY
,t.BASISOFDIAGNOSIS
,t.EXCISIONMARGIN
,t.SCREENDETECTED
,t.SCREENINGSTATUSCOSD_CODE
,t.SCREENINGSTATUSCOSD_NAME
,t.SCREENINGSTATUSFULL_CODE
,t.SCREENINGSTATUSFULL_NAME
,t.ER_STATUS
,t.ER_SCORE
,t.PR_STATUS
,t.PR_SCORE
,t.HER2_STATUS
,t.NPI
,t.DUKES
,t.FIGO
,t.BRESLOW
,t.GLEASON_PRIMARY
,t.GLEASON_SECONDARY
,t.GLEASON_TERTIARY
,t.GLEASON_COMBINED
,t.DIAG_TRUST
,t.DIAG_TRUST_NAME
,t.CHRL_TOT_27_03
,t.CHRL_TOT_78_06
,t.FIRSTMDTMEETINGDATE
,t.EVENTDATE_PS
,t.PERFORMANCESTATUS
,t.EVENTDATE_CNS
,t.CLINICALNURSESPECIALIST
,t.EVENTDATE_FEV1P
,t.FEV1PERCENTAGE
,t.EVENTDATE_FEV1A
,t.FEV1ABSOLUTEVALUE
,t.EVENTDATE_CCP
,t.CANCERCAREPLANINTENT
,t.EVENTDATE_SMOKE
,t.SMOKINGSTATUS
,t.EVENTDATE_PSA
,t.PSA_DIAGNOSIS
,t.DIFFUSION_CAPACITY_RESULT
,t.DIFFUSION_CAPACITY_DATE
,t.CCG_CODE
,t.CCG_NAME
,t.STP_CODE
,t.STP_NAME
,t.CANALLIANCE_CODE
,t.CANALLIANCE_NAME
,t.NHS_REGION_CODE
,t.NHS_REGION_NAME
,t.ICB_CODE
,t.ICB_NAME
,t.ENG_LOC_CODE
,t.ENG_LOC_NAME
,t.GEOG_BOUNDARY_YEAR
,t.RURAL_URBAN_IND_CODE
,t.RURAL_URBAN_IND_NAME
,t.IMD_QUINTILE
,t.IMD_DECILE
,t.IMD_YEAR
,t.RT_FLAG
,t.CT_FLAG
,t.SG_FLAG
,t.ROUTE_CODE
,t.FINAL_ROUTE
,t.dmicImportLogId
,t.NDR001_ID
,t.UniqSubmissionId
,t.Unique_MonthId
,t.dmicSystemId
,t.dmicDateAdded
,t.dmPracticeCode
,t.dmIcbOfRegistration
,t.dmSubIcbOfRegistration
,t.dmCCGCode
,t.dmSTPCode
,t.dmCanAllianceCode
,t.dmICBCode
,t.dmIcbCommissioner
,t.dmSubIcbCommissioner
,t.dmIcbResidenceSubmitted
,t.dmSubIcbResidenceSubmitted
,t.dmCommissionerDerivationReason
,t.dmicRecordHash

from [NDRSCANREG].NDR001CancerRegistry T
where  t.UniqSubmissionId = (select max(UniqSubmissionId) from [NDRSCANREG].ActiveSubmission X) 

	
GO



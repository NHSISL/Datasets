CREATE TABLE [Denormalised].[Materialised_vIP_EncounterDenormalised] (
	[SK_EncounterID] BIGINT NOT NULL
	,[dv_Extract_Type] VARCHAR(200) NULL
	,[dv_Query_ID] VARCHAR(10) NULL
	,[dv_FinYear] VARCHAR(30) NULL
	,[dv_FinMonth] TINYINT NULL
	,[dv_Activity_Period_Date] INT NULL
	,[Generated_Record_ID] BIGINT NULL
	,[Spell_Identifier] BIGINT NULL
	,[Unique_CDS_Identifier] VARCHAR(35) NULL
	,[Hospital_Provider_Spell_No] VARCHAR(20) NULL
	,[Referrer_Code] VARCHAR(8) NULL
	,[Referring_Organisation_Code] VARCHAR(12) NULL
	,[Organisation_Code_Patient_Pathway_Identifier] VARCHAR(12) NULL
	,[RTT_Patient_Pathway_Identifier] VARCHAR(20) NULL
	,[RTT_Period_Start_Date] DATE NULL
	,[RTT_Period_End_Date] DATE NULL
	,[RTT_Length_Derived] SMALLINT NULL
	,[RTT_Status] VARCHAR(2) NULL
	,[Decided_To_Admit_Date] DATE NULL
	,[Episode_Start_Date] DATE NULL
	,[Episode_End_Date] DATE NULL
	,[dv_EpisodeGrossLengthOfStay] INT NULL
	,[Episode_Number] TINYINT NULL
	,[Last_Episode_In_Spell_Indicator] VARCHAR(1) NULL
	,[Start_Date_Hospital_Provider_Spell] DATE NULL
	,[Start_Time_Hospital_Provider_Spell] TIME(0) NULL
	,[End_Date_Hospital_Provider_Spell] DATE NULL
	,[Discharge_Time_Hospital_Provider_Spell] TIME(0) NULL
	,[Ready_For_Discharge_Date] DATE NULL
	,[dv_LengthOfStay_Gross] INT NULL
	,[CDS_Activity_Date] DATE NULL
	,[Source_Of_Admission_Hospital_Provider_Spell] VARCHAR(2) NULL
	,[Discharge_Destination_Hospital_Provider_Spell] VARCHAR(2) NULL
	,[Discharge_Method_Hospital_Provider_Spell] VARCHAR(1) NULL
	,[Administrative_Category_On_Admission] VARCHAR(2) NULL
	,[First_Regular_Day_Night_Admission] VARCHAR(1) NULL
	,[Intended_Management] VARCHAR(1) NULL
	,[Patient_Classification] VARCHAR(1) NULL
	,[Admission_Method_Hospital_Provider_Spell] VARCHAR(2) NULL
	,[Age_Group_Intended_At_Epiend] VARCHAR(1) NULL
	,[Neonatal_Level_Of_Care] VARCHAR(1) NULL
	,[Number_Diagnoses] INT NULL
	,[Number_Procedures] INT NULL
	,[Number_Unbundled_HRGs] INT NULL
	,[SK_PatientID] INT NULL
	,[Local_Patient_Identifier] VARCHAR(30) NULL
	,[Carer_Support_Indicator] VARCHAR(2) NULL
	,[Ethnic_Category_Code] VARCHAR(2) NULL
	,[Age_At_CDS_Activity_Date] SMALLINT NULL
	,[Birth_Date] DATE NULL
	,[dv_YearOfBirth] INT NULL
	,[Gender_Code] VARCHAR(1) NULL
	,[Postcode_Of_Usual_Address] VARCHAR(8) NULL
	,[dv_LSOA] VARCHAR(9) NULL
	,[Legal_Status_Classification_Code] VARCHAR(2) NULL
	,[GP_Code_Original_Data] VARCHAR(8) NULL
	,[GP_Practice_Code_Original_Data] VARCHAR(12) NULL
	,[GP_Practice_Code_Derived] VARCHAR(12) NULL
	,[Provider_Reference_No] VARCHAR(17) NULL
	,[Commissioner_Reference_No] VARCHAR(17) NULL
	,[Commissioner_Serial_No_Agreement_No] VARCHAR(6) NULL
	,[NHS_Service_Agreement_Line_No] VARCHAR(10) NULL
	,[Consultant_Code] VARCHAR(8) NULL
	,[Main_Specialty_Code] VARCHAR(3) NULL
	,[Treatment_Function_Code] VARCHAR(3) NULL
	,[Local_Sub_Specialty_Code] VARCHAR(8) NULL
	,[Ward_Code_At_Episode_Start_Date] VARCHAR(12) NULL
	,[Ward_Code_At_Episode_End_Date] VARCHAR(12) NULL
	,[dv_WardCode_At_Admission] VARCHAR(12) NULL
	,[dv_WardCode_At_Discharge] VARCHAR(12) NULL
	,[dv_SpecCom_ServiceCode_National_Episode] VARCHAR(8) NULL
	,[dv_SpecCom_ServiceCode_National_Spell] VARCHAR(8) NULL
	,[Organisation_Code_Code_Of_Provider] VARCHAR(12) NULL
	,[Organisation_Code_Code_Of_Commissioner] VARCHAR(12) NULL
	,[Site_Code_Of_Treatment_At_Start_Of_Episode] VARCHAR(5) NULL
	,[Organisation_Code_PCT_Of_Residence] VARCHAR(12) NULL
	,[Commissioner_Code_Original_Data] VARCHAR(12) NULL
	,[PCT_Derived_From_GP_Practice] VARCHAR(12) NULL
	,[Patient_Postcode_Derived_PCT] VARCHAR(12) NULL
	,[dv_Commissioner_Code_Of_Residence] INT NULL
	,[dv_Purchaser_ID] VARCHAR(15) NULL
	,[Programme_Budgeting_Category] VARCHAR(8) NULL
	,[Core_HRG_Calculated] VARCHAR(5) NULL
	,[Spell_Core_HRG] VARCHAR(5) NULL
	,[dv_HRG] VARCHAR(5) NULL
	,[dv_Local_Cost_Code] VARCHAR(30) NULL
	,[Spell_In_Pbr_Not_In_Pbr] TINYINT NULL
	,[dv_IsPBR] BIT NULL
	,[dv_ApplicableTariff] REAL NULL
	,[dv_Base_Cost] REAL NULL
	,[dv_IsShortStay] BIT NULL
	,[dv_SpecialServiceID] VARCHAR(3) NULL
	,[dv_ServiceAdjustment_Cost] REAL NULL
	,[dv_BestPracticeTariff_Code] VARCHAR(5) NULL
	,[dv_SpecialistPalliativeCareDays] INT NULL
	,[dv_RehabDays] INT NULL
	,[dv_DelayedDischargeDays] INT NULL
	,[dv_TariffType] VARCHAR(5) NULL
	,[dv_LengthOfStay_Net] SMALLINT NULL
	,[dv_ExcessBedDays] INT NULL
	,[dv_ExcessBedDays_Cost] REAL NULL
	,[dv_MFF_Index_Applied] REAL NULL
	,[PbR_Final_Tariff] DECIMAL(9, 2) NULL
	,[dv_Total_Cost_Inc_MFF] MONEY NULL
	,[dv_IsSpell] BIT NULL
	,[Primary_Diagnosis_Code] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_1] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_2] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_3] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_4] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_5] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_6] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_7] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_8] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_9] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_10] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_11] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_12] VARCHAR(7) NULL
	,[Operation_Status] VARCHAR(1) NULL
	,[Primary_Procedure_Code] VARCHAR(7) NULL
	,[Primary_Procedure_Date] DATE NULL
	,[Secondary_Procedure_Code_1] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_1] DATE NULL
	,[Secondary_Procedure_Code_2] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_2] DATE NULL
	,[Secondary_Procedure_Code_3] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_3] DATE NULL
	,[Secondary_Procedure_Code_4] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_4] DATE NULL
	,[Secondary_Procedure_Code_5] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_5] DATE NULL
	,[Secondary_Procedure_Code_6] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_6] DATE NULL
	,[Secondary_Procedure_Code_7] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_7] DATE NULL
	,[Secondary_Procedure_Code_8] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_8] DATE NULL
	,[Secondary_Procedure_Code_9] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_9] DATE NULL
	,[Secondary_Procedure_Code_10] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_10] DATE NULL
	,[Secondary_Procedure_Code_11] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_11] DATE NULL
	,[Secondary_Procedure_Code_12] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_12] DATE NULL
	,[Unbundled_HRG_1] VARCHAR(5) NULL
	,[Unbundled_HRG_2] VARCHAR(5) NULL
	,[Unbundled_HRG_3] VARCHAR(5) NULL
	,[Unbundled_HRG_4] VARCHAR(5) NULL
	,[Unbundled_HRG_5] VARCHAR(5) NULL
	,[Unbundled_HRG_6] VARCHAR(5) NULL
	,[Unbundled_HRG_7] VARCHAR(5) NULL
	,[Unbundled_HRG_8] VARCHAR(5) NULL
	,[Unbundled_HRG_9] VARCHAR(5) NULL
	,[Unbundled_HRG_10] VARCHAR(5) NULL
	,[Unbundled_HRG_11] VARCHAR(5) NULL
	,[Unbundled_HRG_12] VARCHAR(5) NULL
	,[dv_Unbundled_Days_Total] INT NULL
	,[dv_Unbundled_Cost_Total] INT NULL
	,[dv_Critical_CareDay_Count] INT NULL
	,[ActivityDate] DATE NOT NULL
	,[ActivityPeriod] INT NOT NULL
	)
	WITH (
			CLUSTERED COLUMNSTORE INDEX
			,DISTRIBUTION = HASH ([Organisation_Code_Code_Of_Commissioner])
			);

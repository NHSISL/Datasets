CREATE TABLE [Denormalised].[Materialised_vOP_EncounterDenormalised] (
	[SK_EncounterID] BIGINT NOT NULL
	,[dv_Extract_Type] VARCHAR(200) NULL
	,[dv_Query_ID] VARCHAR(7) NULL
	,[dv_FinYear] VARCHAR(30) NULL
	,[dv_FinMonth] TINYINT NULL
	,[dv_Activity_Period_Date] INT NULL
	,[dv_Month_At_End_Activity] DATE NOT NULL
	,[Generated_Record_ID] BIGINT NULL
	,[Attendance_Identifier] VARCHAR(15) NULL
	,[Spell_Identifier] BIGINT NULL
	,[Unique_CDS_Identifier] VARCHAR(35) NULL
	,[Referrer_Code] VARCHAR(8) NULL
	,[Referring_Organisation_Code] VARCHAR(12) NULL
	,[Referral_Request_Received_Date] DATE NULL
	,[Priority_Type] TINYINT NULL
	,[Service_Type_Requested] TINYINT NULL
	,[Source_Of_Referral_For_Outpatients] VARCHAR(2) NULL
	,[Is_Valid_UBRN] BIT NULL
	,[UBRN_Occurrence_Count] BIGINT NULL
	,[Organisation_Code_Patient_Pathway_Identifier] VARCHAR(12) NULL
	,[RTT_Patient_Pathway_Identifier] VARCHAR(20) NULL
	,[RTT_Period_Start_Date] DATE NULL
	,[RTT_Period_End_Date] DATE NULL
	,[RTT_Length_Derived] SMALLINT NULL
	,[RTT_Status] VARCHAR(2) NULL
	,[Appointment_Date] DATE NULL
	,[Appointment_Time] TIME(0) NULL
	,[CDS_Activity_Date] DATE NULL
	,[Administrative_Category] VARCHAR(2) NULL
	,[First_Attendance] VARCHAR(1) NULL
	,[Attended_Or_Did_Not_Attend] VARCHAR(1) NULL
	,[Outcome_Of_Attendance] VARCHAR(1) NULL
	,[Consultant_Code] VARCHAR(8) NULL
	,[Medical_Staff_Type_Seeing_Patient] VARCHAR(2) NULL
	,[Location_Type_Code] VARCHAR(3) NULL
	,[SK_PatientID] INT NULL
	,[Local_Patient_Identifier] VARCHAR(10) NULL
	,[Ethnic_Category_Code] VARCHAR(2) NULL
	,[Age] SMALLINT NULL
	,[dv_YearOfBirth] SMALLINT NULL
	,[Gender_Code] CHAR(1) NULL
	,[Postcode_Of_Usual_Address] VARCHAR(8) NULL
	,[dv_LSOA] VARCHAR(9) NULL
	,[GP_Code] VARCHAR(8) NULL
	,[GP_Practice_Code_Original_Data] VARCHAR(12) NULL
	,[GP_Practice_Code_Derived] VARCHAR(12) NULL
	,[Provider_Reference_No] VARCHAR(17) NULL
	,[Commissioner_Reference_No] VARCHAR(17) NULL
	,[Commissioning_Serial_No_Agreement_No] VARCHAR(6) NULL
	,[NHS_Service_Agreement_Line_No] VARCHAR(10) NULL
	,[Main_Specialty_Code] VARCHAR(3) NULL
	,[Treatment_Function_Code] VARCHAR(3) NULL
	,[Local_Sub_Specialty_Code] VARCHAR(8) NULL
	,[Clinic_Code] VARCHAR(12) NULL
	,[dv_SpecCom_ServiceCode_National] VARCHAR(8) NULL
	,[Spell_NPOC] VARCHAR(3) NULL
	,[Organisation_Code_Code_Of_Provider] VARCHAR(12) NULL
	,[Site_Code_Of_Treatment] VARCHAR(12) NULL
	,[Organisation_Code_PCT_Of_Residence] VARCHAR(12) NULL
	,[Patient_Postcode_Derived_PCT] VARCHAR(12) NULL
	,[Organisation_Code_Code_Of_Commissioner] VARCHAR(12) NULL
	,[PCT_Derived_From_GP_Practice] VARCHAR(12) NULL
	,[dv_Commissioner_Code_Of_Residence] VARCHAR(15) NULL
	,[dv_Purchaser_ID] VARCHAR(15) NULL
	,[Core_HRG] VARCHAR(5) NULL
	,[HRG_Used_For_Tariff] VARCHAR(2) NULL
	,[dv_HRG] VARCHAR(5) NULL
	,[dv_Local_Cost_Code] VARCHAR(30) NULL
	,[Spell_In_PbR_Not_In_PbR] TINYINT NULL
	,[dv_IsPBR] BIT NULL
	,[dv_ApplicableTariff] REAL NULL
	,[dv_Base_Cost] REAL NULL
	,[dv_TariffType] VARCHAR(5) NULL
	,[dv_MFF_Index_Applied] REAL NULL
	,[Tariff_Initial_Amount_National] DECIMAL(9, 2) NULL
	,[Tariff_Pre_MFF_Adjusted_National] DECIMAL(9, 2) NULL
	,[Tariff_Total_Payment_National] DECIMAL(9, 2) NULL
	,[PbR_Final_Tariff] DECIMAL(9, 2) NULL
	,[dv_Total_Cost_Inc_MFF] REAL NULL
	,[Number_Diagnosis] INT NULL
	,[Primary_Diagnosis_Code] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_1] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_2] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_3] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_4] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_5] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_6] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_7] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_8] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_9] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_10] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_11] VARCHAR(7) NULL
	,[Secondary_Diagnosis_Code_12] VARCHAR(7) NULL
	,[Operation_Status] VARCHAR(1) NULL
	,[Number_Procedures] INT NULL
	,[Primary_Procedure_Code] VARCHAR(7) NULL
	,[Primary_Procedure_Date] DATE NULL
	,[Secondary_Procedure_Code_1] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_1] DATE NULL
	,[Secondary_Procedure_Code_2] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_2] DATE NULL
	,[Secondary_Procedure_Code_3] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_3] DATE NULL
	,[Secondary_Procedure_Code_4] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_4] DATE NULL
	,[Secondary_Procedure_Code_5] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_5] DATE NULL
	,[Secondary_Procedure_Code_6] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_6] DATE NULL
	,[Secondary_Procedure_Code_7] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_7] DATE NULL
	,[Secondary_Procedure_Code_8] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_8] DATE NULL
	,[Secondary_Procedure_Code_9] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_9] DATE NULL
	,[Secondary_Procedure_Code_10] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_10] DATE NULL
	,[Secondary_Procedure_Code_11] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_11] DATE NULL
	,[Secondary_Procedure_Code_12] VARCHAR(7) NULL
	,[Secondary_Procedure_Date_12] DATE NULL
	,[Unbundled_HRG_1] VARCHAR(5) NULL
	,[Unbundled_HRG_2] VARCHAR(5) NULL
	,[Unbundled_HRG_3] VARCHAR(5) NULL
	,[Unbundled_HRG_4] VARCHAR(5) NULL
	,[Unbundled_HRG_5] VARCHAR(5) NULL
	,[Unbundled_HRG_6] VARCHAR(5) NULL
	,[Unbundled_HRG_7] VARCHAR(5) NULL
	,[Unbundled_HRG_8] VARCHAR(5) NULL
	,[Unbundled_HRG_9] VARCHAR(5) NULL
	,[Unbundled_HRG_10] VARCHAR(5) NULL
	,[Unbundled_HRG_11] VARCHAR(5) NULL
	,[Unbundled_HRG_12] VARCHAR(5) NULL
	,[Number_Unbundled_HRGs] INT NULL
	,[Number_Unbundled_Non_Priced_HRGs] INT NULL
	,[Number_Unbundled_Priced_HRGs] INT NULL
	,[ActivityDate] DATE NOT NULL
	,[ActivityPeriod] INT NOT NULL
	)
	WITH (
			CLUSTERED COLUMNSTORE INDEX
			,DISTRIBUTION = HASH ([Organisation_Code_Code_Of_Commissioner])
			);

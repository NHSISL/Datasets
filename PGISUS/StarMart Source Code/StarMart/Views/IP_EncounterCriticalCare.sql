CREATE VIEW [StarMart].[IP_EncounterCriticalCare]
AS
SELECT [Generated_Record_ID] = [CC].[Episode ID]
	,[SK_Encounter_ID] = [CC].[Episode ID]
	,[SUS_Version] = [CC].[SUS Version]
	,[Spell_Identifier] = [CC].[Spell Identifier]
	,[Episode_ID] = [CC].[Episode ID]
	--
	,[SK_Patient_ID] = [CC_Pseudo].[SK_PatientID]
	,[Episode_Number] = [CC].[Episode Number]
	,[Organisation_Code_Code_Of_Provider] = [CC].[Organisation Code (Code Of Provider)]
	,[Organisation_Code_Code_Of_Commissioner] = [CC].[Organisation Code (Code Of Commissioner)]
	,[Critical_Care_Type] = [CC].[Critical Care Type]
	,[Start_Date_Hospital_Provider_Spell] = [CC].[Start Date (Hospital Provider Spell)]
	,[End_Date_Hospital_Provider_Spell] = [CC].[End Date (Hospital Provider Spell)]
	,[Episode_Start_Date] = [CC].[Episode Start Date]
	,[Episode_End_Date] = [CC].[Episode End Date]
	,[CC_Patient_Type] = [CC].[CC Patient Type]
	,[CC_Days_For_LOS] = [CC].[CC Days For LOS]
	,[Total_Episode_Level_CC_Days_For_LOS] = [CC].[Total Episode Level CC Days For LOS]
	,[CC_Days_For_Tariff] = [CC].[CC Days For Tariff]
	,[Total_Episode_Level_CC_Days_For_Tariff] = [CC].[Total Episode Level CC Days For Tariff]
	,[PBR_CC_Indicator] = [CC].[PBR CC Indicator]
	,[Excluded_Reason] = [CC].[Excluded Reason]
	,[Critical_Care_Period_Number] = [CC].[Critical Care Period Number]
	,[CC_Unbundled_HRG] = [CC].[CC Unbundled HRG]
	,[CC_Unit_Cost] = [CC].[CC Unit Cost]
	,[CC_Total_Cost] = [CC].[CC Total Cost]
	,[Critical_Care_Start_Date] = [CC].[Critical Care Start Date]
	,[Critical_Care_Start_Time] = [CC].[Critical Care Start Time]
	,[Critical_Care_Discharge_Date] = [CC].[Critical Care Discharge Date]
	,[Critical_Care_Discharge_Time] = [CC].[Critical Care Discharge Time]
	,[Activity_Date_Critical_Care] = [CC].[Activity Date (Critical Care)]
	,[Critical_Care_Unit_Function] = [CC].[Critical Care Unit Function]
	,[Critical_Care_Unit_Bed_Configuration] = [CC].[Critical Care Unit Bed Configuration]
	,[Critical_Care_Admission_Source] = [CC].[Critical Care Admission Source]
	,[Critical_Care_Source_Location] = [CC].[Critical Care Source Location]
	,[Critical_Care_Admission_Type] = [CC].[Critical Care Admission Type]
	,[Gestation_Length_At_Delivery] = [CC].[Gestation Length (At Delivery)]
	,[Advanced_Respiratory_Support_Days] = [CC].[Advanced Respiratory Support Days]
	,[Basic_Respiratory_Support_Days] = [CC].[Basic Respiratory Support Days]
	,[Advanced_Cardiovascular_Support_Days] = [CC].[Advanced Cardiovascular Support Days]
	,[Basic_Cardiovascular_Support_Days] = [CC].[Basic Cardiovascular Support Days]
	,[Renal_Support_Days] = [CC].[Renal Support Days]
	,[Neurological_Support_Days] = [CC].[Neurological Support Days]
	,[Gastro-Intestinal_Support_Days] = [CC].[Gastro-Intestinal Support Days]
	,[Dermatological_Support_Days] = [CC].[Dermatological Support Days]
	,[Liver_Support_Days] = [CC].[Liver Support Days]
	,[Organ_Support_Maximum] = [CC].[Organ Support Maximum]
	,[Critical_Care_Level_2_Days] = [CC].[Critical Care Level 2 Days]
	,[Critical_Care_Level_3_Days] = [CC].[Critical Care Level 3 Days]
	,[Person_Weight] = [CC].[Person Weight]
	,[Critical_Care_Activity_Code_1] = [CC].[Critical Care Activity Code 1]
	,[Critical_Care_Activity_Code_2] = [CC].[Critical Care Activity Code 2]
	,[Critical_Care_Activity_Code_3] = [CC].[Critical Care Activity Code 3]
	,[Critical_Care_Activity_Code_4] = [CC].[Critical Care Activity Code 4]
	,[Critical_Care_Activity_Code_5] = [CC].[Critical Care Activity Code 5]
	,[Critical_Care_Activity_Code_6] = [CC].[Critical Care Activity Code 6]
	,[Critical_Care_Activity_Code_7] = [CC].[Critical Care Activity Code 7]
	,[Critical_Care_Activity_Code_8] = [CC].[Critical Care Activity Code 8]
	,[Critical_Care_Activity_Code_9] = [CC].[Critical Care Activity Code 9]
	,[Critical_Care_Activity_Code_10] = [CC].[Critical Care Activity Code 10]
	,[Critical_Care_Activity_Code_11] = [CC].[Critical Care Activity Code 11]
	,[Critical_Care_Activity_Code_12] = [CC].[Critical Care Activity Code 12]
	,[Critical_Care_Activity_Code_13] = [CC].[Critical Care Activity Code 13]
	,[Critical_Care_Activity_Code_14] = [CC].[Critical Care Activity Code 14]
	,[Critical_Care_Activity_Code_15] = [CC].[Critical Care Activity Code 15]
	,[Critical_Care_Activity_Code_16] = [CC].[Critical Care Activity Code 16]
	,[Critical_Care_Activity_Code_17] = [CC].[Critical Care Activity Code 17]
	,[Critical_Care_Activity_Code_18] = [CC].[Critical Care Activity Code 18]
	,[Critical_Care_Activity_Code_19] = [CC].[Critical Care Activity Code 19]
	,[Critical_Care_Activity_Code_20] = [CC].[Critical Care Activity Code 20]
	,[High_Cost_Drugs_Opcs_1] = [CC].[High Cost Drugs (Opcs) 1]
	,[High_Cost_Drugs_Opcs_2] = [CC].[High Cost Drugs (Opcs) 2]
	,[High_Cost_Drugs_Opcs_3] = [CC].[High Cost Drugs (Opcs) 3]
	,[High_Cost_Drugs_Opcs_4] = [CC].[High Cost Drugs (Opcs) 4]
	,[High_Cost_Drugs_Opcs_5] = [CC].[High Cost Drugs (Opcs) 5]
	,[High_Cost_Drugs_Opcs_6] = [CC].[High Cost Drugs (Opcs) 6]
	,[High_Cost_Drugs_Opcs_7] = [CC].[High Cost Drugs (Opcs) 7]
	,[High_Cost_Drugs_Opcs_8] = [CC].[High Cost Drugs (Opcs) 8]
	,[High_Cost_Drugs_Opcs_9] = [CC].[High Cost Drugs (Opcs) 9]
	,[High_Cost_Drugs_Opcs_10] = [CC].[High Cost Drugs (Opcs) 10]
	,[High_Cost_Drugs_Opcs_11] = [CC].[High Cost Drugs (Opcs) 11]
	,[High_Cost_Drugs_Opcs_12] = [CC].[High Cost Drugs (Opcs) 12]
	,[High_Cost_Drugs_Opcs_13] = [CC].[High Cost Drugs (Opcs) 13]
	,[High_Cost_Drugs_Opcs_14] = [CC].[High Cost Drugs (Opcs) 14]
	,[High_Cost_Drugs_Opcs_15] = [CC].[High Cost Drugs (Opcs) 15]
	,[High_Cost_Drugs_Opcs_16] = [CC].[High Cost Drugs (Opcs) 16]
	,[High_Cost_Drugs_Opcs_17] = [CC].[High Cost Drugs (Opcs) 17]
	,[High_Cost_Drugs_Opcs_18] = [CC].[High Cost Drugs (Opcs) 18]
	,[High_Cost_Drugs_Opcs_19] = [CC].[High Cost Drugs (Opcs) 19]
	,[High_Cost_Drugs_Opcs_20] = [CC].[High Cost Drugs (Opcs) 20]
	,[Critical_Care_Discharge_Ready_Date] = [CC].[Critical Care Discharge Ready Date]
	,[Critical_Care_Discharge_Ready_Time] = [CC].[Critical Care Discharge Ready Time]
	,[Critical_Care_Discharge_Status] = [CC].[Critical Care Discharge Status]
	,[Critical_Care_Discharge_Destination] = [CC].[Critical Care Discharge Destination]
	,[Critical_Care_Discharge_Location] = [CC].[Critical Care Discharge Location]
	--
	,[dv_Activity_Date] = [CC].[ActivityDate]
	,[dv_Activity_Period] = [CC].[ActivityPeriod]
	,[dv_ISL_Datetime_Published] = GETDATE()
FROM [Casted].[IP_pbr_preprocess_CC] AS [CC]
INNER JOIN [Casted].[IP_pbr_preprocess_CC_Pseudo] AS [CC_Pseudo]
	ON (
			[CC].[Spell Identifier] = [CC_Pseudo].[Spell Identifier]
			AND [CC].[ImportRunDataFileId] = [CC_Pseudo].[ImportRunDataFileId]
			AND [CC].[Id] = [CC_Pseudo].[Id]
			);

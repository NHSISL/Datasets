/*
    Investigation: Uniqueness
    Run: uv run run_tests.py --run investigations/investigate_uniqueness.sql
         Or execute directly in Snowsight â€” set the USE DATABASE and schema
         variables below to match your ICB.

    For each table/column, shows duplicate values with their occurrence
    counts. Helps identify whether duplicates are systematic (few values,
    many copies) or scattered.
*/

USE DATABASE "Data_Store_OLIDS_Clinical_Validation";  -- Replace with your ICB's OLIDS database name

SET schema_masked = 'OLIDS_MASKED';        -- Change if your ICB uses a different name (e.g. OLIDS_PCD)
SET schema_common = 'OLIDS_COMMON';
SET schema_terminology = 'OLIDS_TERMINOLOGY';

-- PATIENT
SELECT 'PATIENT' AS table_name, 'id' AS column_name, id AS duplicate_value, COUNT(*) AS occurrences
FROM OLIDS_MASKED.PATIENT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_MASKED.PATIENT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PERSON
SELECT 'PERSON', 'id', id, COUNT(*)
FROM OLIDS_MASKED.PERSON GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PERSON', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_MASKED.PERSON GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PERSON', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_MASKED.PERSON GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PERSON', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_MASKED.PERSON GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PATIENT_ADDRESS
SELECT 'PATIENT_ADDRESS', 'id', id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_ADDRESS GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_ADDRESS', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_ADDRESS GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_ADDRESS', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_ADDRESS GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_ADDRESS', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_MASKED.PATIENT_ADDRESS GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PATIENT_CONTACT
SELECT 'PATIENT_CONTACT', 'id', id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_CONTACT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_CONTACT', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_CONTACT GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_CONTACT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_CONTACT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_CONTACT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_MASKED.PATIENT_CONTACT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PATIENT_UPRN
SELECT 'PATIENT_UPRN', 'id', id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_UPRN GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_UPRN', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_UPRN GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_UPRN', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_MASKED.PATIENT_UPRN GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_UPRN', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_MASKED.PATIENT_UPRN GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PATIENT_PERSON
SELECT 'PATIENT_PERSON', 'id', id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_PERSON GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_PERSON', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_PERSON GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_PERSON', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_PERSON GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_PERSON', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.PATIENT_PERSON GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- EPISODE_OF_CARE
SELECT 'EPISODE_OF_CARE', 'id', id, COUNT(*)
FROM OLIDS_COMMON.EPISODE_OF_CARE GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'EPISODE_OF_CARE', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.EPISODE_OF_CARE GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'EPISODE_OF_CARE', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.EPISODE_OF_CARE GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'EPISODE_OF_CARE', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.EPISODE_OF_CARE GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- ENCOUNTER
SELECT 'ENCOUNTER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.ENCOUNTER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ENCOUNTER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.ENCOUNTER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ENCOUNTER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.ENCOUNTER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ENCOUNTER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.ENCOUNTER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- OBSERVATION
SELECT 'OBSERVATION', 'id', id, COUNT(*)
FROM OLIDS_COMMON.OBSERVATION GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'OBSERVATION', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.OBSERVATION GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'OBSERVATION', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.OBSERVATION GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'OBSERVATION', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.OBSERVATION GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- MEDICATION_STATEMENT
SELECT 'MEDICATION_STATEMENT', 'id', id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_STATEMENT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_STATEMENT', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_STATEMENT GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_STATEMENT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_STATEMENT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_STATEMENT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_STATEMENT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- MEDICATION_ORDER
SELECT 'MEDICATION_ORDER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_ORDER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_ORDER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_ORDER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_ORDER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_ORDER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'MEDICATION_ORDER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.MEDICATION_ORDER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- DIAGNOSTIC_ORDER
SELECT 'DIAGNOSTIC_ORDER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.DIAGNOSTIC_ORDER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'DIAGNOSTIC_ORDER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.DIAGNOSTIC_ORDER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'DIAGNOSTIC_ORDER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.DIAGNOSTIC_ORDER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'DIAGNOSTIC_ORDER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.DIAGNOSTIC_ORDER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- ALLERGY_INTOLERANCE
SELECT 'ALLERGY_INTOLERANCE', 'id', id, COUNT(*)
FROM OLIDS_COMMON.ALLERGY_INTOLERANCE GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ALLERGY_INTOLERANCE', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.ALLERGY_INTOLERANCE GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ALLERGY_INTOLERANCE', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.ALLERGY_INTOLERANCE GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ALLERGY_INTOLERANCE', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.ALLERGY_INTOLERANCE GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PROCEDURE_REQUEST
SELECT 'PROCEDURE_REQUEST', 'id', id, COUNT(*)
FROM OLIDS_COMMON.PROCEDURE_REQUEST GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PROCEDURE_REQUEST', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.PROCEDURE_REQUEST GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PROCEDURE_REQUEST', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.PROCEDURE_REQUEST GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PROCEDURE_REQUEST', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.PROCEDURE_REQUEST GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- REFERRAL_REQUEST
SELECT 'REFERRAL_REQUEST', 'id', id, COUNT(*)
FROM OLIDS_COMMON.REFERRAL_REQUEST GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'REFERRAL_REQUEST', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.REFERRAL_REQUEST GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'REFERRAL_REQUEST', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.REFERRAL_REQUEST GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'REFERRAL_REQUEST', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.REFERRAL_REQUEST GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- APPOINTMENT
SELECT 'APPOINTMENT', 'id', id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- APPOINTMENT_PRACTITIONER
SELECT 'APPOINTMENT_PRACTITIONER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT_PRACTITIONER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT_PRACTITIONER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT_PRACTITIONER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT_PRACTITIONER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT_PRACTITIONER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'APPOINTMENT_PRACTITIONER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.APPOINTMENT_PRACTITIONER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PATIENT_REGISTERED_PRACTITIONER_IN_ROLE
SELECT 'PATIENT_REGISTERED_PRACTITIONER_IN_ROLE', 'id', id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_REGISTERED_PRACTITIONER_IN_ROLE GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_REGISTERED_PRACTITIONER_IN_ROLE', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_REGISTERED_PRACTITIONER_IN_ROLE GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_REGISTERED_PRACTITIONER_IN_ROLE', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.PATIENT_REGISTERED_PRACTITIONER_IN_ROLE GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PATIENT_REGISTERED_PRACTITIONER_IN_ROLE', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.PATIENT_REGISTERED_PRACTITIONER_IN_ROLE GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- LOCATION
SELECT 'LOCATION', 'id', id, COUNT(*)
FROM OLIDS_COMMON.LOCATION GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.LOCATION GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.LOCATION GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.LOCATION GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- LOCATION_CONTACT
SELECT 'LOCATION_CONTACT', 'id', id, COUNT(*)
FROM OLIDS_COMMON.LOCATION_CONTACT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION_CONTACT', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.LOCATION_CONTACT GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION_CONTACT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.LOCATION_CONTACT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'LOCATION_CONTACT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.LOCATION_CONTACT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- FLAG
SELECT 'FLAG', 'id', id, COUNT(*)
FROM OLIDS_COMMON.FLAG GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'FLAG', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.FLAG GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'FLAG', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.FLAG GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'FLAG', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.FLAG GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- ORGANISATION
SELECT 'ORGANISATION', 'id', id, COUNT(*)
FROM OLIDS_COMMON.ORGANISATION GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ORGANISATION', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.ORGANISATION GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ORGANISATION', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.ORGANISATION GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'ORGANISATION', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.ORGANISATION GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PRACTITIONER
SELECT 'PRACTITIONER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- PRACTITIONER_IN_ROLE
SELECT 'PRACTITIONER_IN_ROLE', 'id', id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER_IN_ROLE GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER_IN_ROLE', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER_IN_ROLE GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER_IN_ROLE', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER_IN_ROLE GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'PRACTITIONER_IN_ROLE', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.PRACTITIONER_IN_ROLE GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- SCHEDULE
SELECT 'SCHEDULE', 'id', id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- SCHEDULE_PRACTITIONER
SELECT 'SCHEDULE_PRACTITIONER', 'id', id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE_PRACTITIONER GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE_PRACTITIONER', 'lds_record_id', lds_record_id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE_PRACTITIONER GROUP BY lds_record_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE_PRACTITIONER', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE_PRACTITIONER GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'SCHEDULE_PRACTITIONER', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_COMMON.SCHEDULE_PRACTITIONER GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- CONCEPT (no lds_record_id)
SELECT 'CONCEPT', 'id', id, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'CONCEPT', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'CONCEPT', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT GROUP BY lds_business_key HAVING COUNT(*) > 1

UNION ALL

-- CONCEPT_MAP (no lds_record_id)
SELECT 'CONCEPT_MAP', 'id', id, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT_MAP GROUP BY id HAVING COUNT(*) > 1
UNION ALL
SELECT 'CONCEPT_MAP', 'lds_id', lds_id, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT_MAP GROUP BY lds_id HAVING COUNT(*) > 1
UNION ALL
SELECT 'CONCEPT_MAP', 'lds_business_key', lds_business_key, COUNT(*)
FROM OLIDS_TERMINOLOGY.CONCEPT_MAP GROUP BY lds_business_key HAVING COUNT(*) > 1

ORDER BY table_name, column_name, occurrences DESC;
